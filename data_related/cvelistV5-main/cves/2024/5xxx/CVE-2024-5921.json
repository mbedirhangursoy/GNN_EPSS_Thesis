{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-5921",
        "assignerOrgId": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
        "state": "PUBLISHED",
        "assignerShortName": "palo_alto",
        "dateReserved": "2024-06-12T15:27:58.017Z",
        "datePublished": "2024-11-27T03:50:13.596Z",
        "dateUpdated": "2025-02-20T22:30:01.359Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "Windows"
                    ],
                    "product": "GlobalProtect App",
                    "vendor": "Palo Alto Networks",
                    "versions": [
                        {
                            "changes": [
                                {
                                    "at": "6.3.2",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "6.3.2",
                            "status": "affected",
                            "version": "6.3.0",
                            "versionType": "custom"
                        },
                        {
                            "changes": [
                                {
                                    "at": "6.2.6",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "6.2.6",
                            "status": "affected",
                            "version": "6.2.0",
                            "versionType": "custom"
                        },
                        {
                            "status": "affected",
                            "version": "6.1.0",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "macOS"
                    ],
                    "product": "GlobalProtect App",
                    "vendor": "Palo Alto Networks",
                    "versions": [
                        {
                            "changes": [
                                {
                                    "at": "6.3.2",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "6.3.2",
                            "status": "affected",
                            "version": "6.3.0",
                            "versionType": "custom"
                        },
                        {
                            "changes": [
                                {
                                    "at": "6.2.6-c857",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "6.2.6-c857",
                            "status": "affected",
                            "version": "6.2.0",
                            "versionType": "custom"
                        },
                        {
                            "status": "affected",
                            "version": "6.1.0",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "Linux"
                    ],
                    "product": "GlobalProtect App",
                    "vendor": "Palo Alto Networks",
                    "versions": [
                        {
                            "changes": [
                                {
                                    "at": "6.2.1-c31",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "6.2.1-c31",
                            "status": "affected",
                            "version": "6.2.0",
                            "versionType": "custom"
                        },
                        {
                            "status": "affected",
                            "version": "6.1.0",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "Android"
                    ],
                    "product": "GlobalProtect App",
                    "vendor": "Palo Alto Networks",
                    "versions": [
                        {
                            "lessThan": "6.1.6",
                            "status": "affected",
                            "version": "6.1.0",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "iOS"
                    ],
                    "product": "GlobalProtect App",
                    "vendor": "Palo Alto Networks",
                    "versions": [
                        {
                            "changes": [
                                {
                                    "at": "6.1.7",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "6.1.7",
                            "status": "affected",
                            "version": "6.1.0",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "FIPS-CC mode"
                    ],
                    "product": "GlobalProtect App",
                    "vendor": "Palo Alto Networks",
                    "versions": [
                        {
                            "status": "unaffected",
                            "version": "6.0.0",
                            "versionType": "custom"
                        },
                        {
                            "status": "unaffected",
                            "version": "5.1.0",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "Windows UWP"
                    ],
                    "product": "GlobalProtect App",
                    "vendor": "Palo Alto Networks",
                    "versions": [
                        {
                            "changes": [
                                {
                                    "at": "6.2.6",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "6.2.6",
                            "status": "affected",
                            "version": "6.2.0",
                            "versionType": "custom"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "No special configuration is required to be affected by this issue."
                        }
                    ],
                    "value": "No special configuration is required to be affected by this issue."
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "Maxime ESCOURBIAC, Michelin CERT"
                },
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "Yassine BENGANA, Abicom for Michelin CERT"
                },
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "Richard Warren and David Cash of AmberWolf"
                }
            ],
            "datePublic": "2024-11-26T02:45:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p></p><p>An insufficient certification validation issue in the Palo Alto Networks GlobalProtect app enables attackers to connect the GlobalProtect app to arbitrary servers. This can enable a local non-administrative operating system user or an attacker on the same subnet to install malicious root certificates on the endpoint and subsequently install malicious software signed by the malicious root certificates on that endpoint.</p><p>Please subscribe to <a target=\"_blank\" rel=\"nofollow\" href=\"https://security.paloaltonetworks.com/rss.xml\">our RSS feed</a> to be alerted to new updates to this and other advisories.</p>"
                        }
                    ],
                    "value": "An insufficient certification validation issue in the Palo Alto Networks GlobalProtect app enables attackers to connect the GlobalProtect app to arbitrary servers. This can enable a local non-administrative operating system user or an attacker on the same subnet to install malicious root certificates on the endpoint and subsequently install malicious software signed by the malicious root certificates on that endpoint.\n\nPlease subscribe to  our RSS feed https://security.paloaltonetworks.com/rss.xml  to be alerted to new updates to this and other advisories."
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>Palo Alto Networks is not aware of any malicious exploitation of this issue. We are aware of a publicly available conference talk and blog posts discussing this issue. A proof of concept for this issue is also publicly available.<br></p>"
                        }
                    ],
                    "value": "Palo Alto Networks is not aware of any malicious exploitation of this issue. We are aware of a publicly available conference talk and blog posts discussing this issue. A proof of concept for this issue is also publicly available."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-233",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-233 Privilege Escalation"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "NO",
                        "Recovery": "USER",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "PRESENT",
                        "attackVector": "PHYSICAL",
                        "baseScore": 6,
                        "baseSeverity": "MEDIUM",
                        "privilegesRequired": "NONE",
                        "providerUrgency": "AMBER",
                        "subAvailabilityImpact": "HIGH",
                        "subConfidentialityImpact": "HIGH",
                        "subIntegrityImpact": "HIGH",
                        "userInteraction": "PASSIVE",
                        "valueDensity": "DIFFUSE",
                        "vectorString": "CVSS:4.0/AV:P/AC:L/AT:P/PR:N/UI:P/VC:N/VI:H/VA:N/SC:H/SI:H/SA:H/AU:N/R:U/V:D/RE:M/U:Amber",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "NONE",
                        "vulnConfidentialityImpact": "NONE",
                        "vulnIntegrityImpact": "HIGH",
                        "vulnerabilityResponseEffort": "MODERATE"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "An attacker on the same subnet as an end user who can influence DNS traffic can cause the user to connect to a malicious GlobalProtect portal."
                        }
                    ]
                },
                {
                    "cvssV4_0": {
                        "Automatable": "NO",
                        "Recovery": "USER",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "PRESENT",
                        "attackVector": "LOCAL",
                        "baseScore": 7.1,
                        "baseSeverity": "HIGH",
                        "privilegesRequired": "LOW",
                        "providerUrgency": "AMBER",
                        "subAvailabilityImpact": "HIGH",
                        "subConfidentialityImpact": "HIGH",
                        "subIntegrityImpact": "HIGH",
                        "userInteraction": "NONE",
                        "valueDensity": "DIFFUSE",
                        "vectorString": "CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:N/VI:H/VA:N/SC:H/SI:H/SA:H/AU:N/R:U/V:D/RE:M/U:Amber",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "NONE",
                        "vulnConfidentialityImpact": "NONE",
                        "vulnIntegrityImpact": "HIGH",
                        "vulnerabilityResponseEffort": "MODERATE"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "A local user with non-administrative privileges connects to a malicious GlobalProtect portal."
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-295",
                            "description": "CWE-295 Improper Certificate Validation",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
                "shortName": "palo_alto",
                "dateUpdated": "2025-02-20T22:30:01.359Z"
            },
            "references": [
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://security.paloaltonetworks.com/CVE-2024-5921"
                },
                {
                    "tags": [
                        "exploit"
                    ],
                    "url": "https://blog.amberwolf.com/blog/2024/november/palo-alto-globalprotect---code-execution-and-privilege-escalation-via-malicious-vpn-server-cve-2024-5921/"
                },
                {
                    "tags": [
                        "exploit"
                    ],
                    "url": "https://github.com/AmberWolfCyber/NachoVPN"
                }
            ],
            "solutions": [
                {
                    "lang": "eng",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>This issue is fixed in GlobalProtect app 6.2.1-c31 on Linux, GlobalProtect app 6.2.6 on Windows, GlobalProtect app 6.2.6-c857 on macOS, GlobalProtect app 6.3.2 on Windows and macOS, and all later GlobalProtect app versions. Additional fixes are under development and will be made available for the remaining platforms (Linux, iOS, and Android).</p>The fix for this vulnerability requires three steps:<br><ol><li>Ensure that all of your GlobalProtect portals use TLS certificate chains that meet the criteria specified in the \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.</li><li>Ensure that the TLS certificate chains used by the GlobalProtect portals are added to the root certificate store in your operating system.</li><li>Install a fixed version of GlobalProtect using one of the deployment options below. This setting enforces strict X.509v3 verification checks on the certificate provided by the GlobalProtect portal.<br></li></ol><p>Note: Prisma Access customers using portals with a *.gpcloudservice.com domain name already have valid TLS certificate chains. The root certificate for these portals is from GoDaddy, which is trusted by default in Windows, macOS, RHEL, Ubuntu, iOS, and Android. Therefore, Prisma Access customers using a GlobalProtect portal with a *.gpcloudservice.com domain name should only need to perform step 3 above.<br><br><b>Important</b>: If your GlobalProtect portals do not use valid X.509V3 TLS certificate chains, this will result in TLS verification failures. To generate a GlobalProtect portal certificate that can be used with a fixed version of GlobalProtect app, refer to the first \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.<b><br></b></p><p><b></b><b></b><b>Warning: Performance Concern:</b> Some customers reported problems connecting to Portals and Gateways when this solution was implemented in certain situations. This is due to certificate providers that rate limit requests for Online Certificate Status Protocol (OCSP) and certificate revocation list (CRL) checks. This happens when multiple users connect to GlobalProtect Portals from a single public IP (such as NAT) around the same time, such as when hundreds or thousands of end users connect around the start of a workday from a single office.<br></p>"
                        }
                    ],
                    "value": "This issue is fixed in GlobalProtect app 6.2.1-c31 on Linux, GlobalProtect app 6.2.6 on Windows, GlobalProtect app 6.2.6-c857 on macOS, GlobalProtect app 6.3.2 on Windows and macOS, and all later GlobalProtect app versions. Additional fixes are under development and will be made available for the remaining platforms (Linux, iOS, and Android).\n\nThe fix for this vulnerability requires three steps:\n  *  Ensure that all of your GlobalProtect portals use TLS certificate chains that meet the criteria specified in the \"FIPS-CC Certification Validation\" table in  our documentation https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues .\n  *  Ensure that the TLS certificate chains used by the GlobalProtect portals are added to the root certificate store in your operating system.\n  *  Install a fixed version of GlobalProtect using one of the deployment options below. This setting enforces strict X.509v3 verification checks on the certificate provided by the GlobalProtect portal.\n\nNote: Prisma Access customers using portals with a *.gpcloudservice.com domain name already have valid TLS certificate chains. The root certificate for these portals is from GoDaddy, which is trusted by default in Windows, macOS, RHEL, Ubuntu, iOS, and Android. Therefore, Prisma Access customers using a GlobalProtect portal with a *.gpcloudservice.com domain name should only need to perform step 3 above.\n\nImportant: If your GlobalProtect portals do not use valid X.509V3 TLS certificate chains, this will result in TLS verification failures. To generate a GlobalProtect portal certificate that can be used with a fixed version of GlobalProtect app, refer to the first \"FIPS-CC Certification Validation\" table in  our documentation https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues .\n\n\nWarning: Performance Concern: Some customers reported problems connecting to Portals and Gateways when this solution was implemented in certain situations. This is due to certificate providers that rate limit requests for Online Certificate Status Protocol (OCSP) and certificate revocation list (CRL) checks. This happens when multiple users connect to GlobalProtect Portals from a single public IP (such as NAT) around the same time, such as when hundreds or thousands of end users connect around the start of a workday from a single office."
                }
            ],
            "source": {
                "defect": [
                    "GPC-19860",
                    "GPC-19861"
                ],
                "discovery": "EXTERNAL"
            },
            "timeline": [
                {
                    "lang": "en",
                    "time": "2025-02-20T22:20:00.000Z",
                    "value": "Updated fix availability for 6.2.1 on Linux and solutions section to provide steps needed for Linux"
                },
                {
                    "lang": "en",
                    "time": "2025-02-05T16:25:00.000Z",
                    "value": "Updated ETA for 6.2.1-HF2 Linux, 6.1.6 Android, 6.1.7 iOS, and 6.2.6 UWP"
                },
                {
                    "lang": "en",
                    "time": "2025-01-17T18:00:00.000Z",
                    "value": "Added 6.2.6-c857 macOS solution"
                },
                {
                    "lang": "en",
                    "time": "2025-01-13T19:00:00.000Z",
                    "value": "Added planned fix version and ETA for 6.1 for Android"
                },
                {
                    "lang": "en",
                    "time": "2024-12-24T22:00:00.000Z",
                    "value": "Updated product status table for GlobalProtect app 6.3.2 and added macOS solution"
                },
                {
                    "lang": "en",
                    "time": "2024-12-19T07:00:00.000Z",
                    "value": "Updated ETAs for GlobalProtect app versions 6.3, 6.2, and 6.1"
                },
                {
                    "lang": "en",
                    "time": "2024-12-16T18:00:00.000Z",
                    "value": "Updated planned fix version and ETA for 6.3 for Windows and macOS"
                },
                {
                    "lang": "en",
                    "time": "2024-12-13T21:50:00.000Z",
                    "value": "Added note to the solution about potential performance concern"
                },
                {
                    "lang": "en",
                    "time": "2024-12-06T17:15:00.000Z",
                    "value": "Updated affected products, added ETAs, clarified solution, and added frequently asked questions"
                },
                {
                    "lang": "en",
                    "time": "2024-11-27T03:35:00.000Z",
                    "value": "Added registry-based deployment option to solution, and added frequently asked questions"
                },
                {
                    "lang": "en",
                    "time": "2024-11-26T20:15:00.000Z",
                    "value": "Clarified impact, solution, and added frequently asked questions"
                },
                {
                    "lang": "en",
                    "time": "2024-11-26T02:45:00.000Z",
                    "value": "Initial publication"
                }
            ],
            "title": "GlobalProtect App: Insufficient Certificate Validation Leads to Privilege Escalation",
            "workarounds": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>You can mitigate this issue for all platforms (<a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-windows-registry\">Windows</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-macos-property-list\">macOS</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-on-linux-endpoints-redhat\">Linux</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-workspaceone-on-ios-devices\">iOS</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-microsoft-intune-on-android-endpoints\">Android</a>) by using the GlobalProtect app 6.0 in FIPS-CC mode or GlobalProtect app 5.1 in FIPS-CC mode. For details, refer to the first \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.</p><p>Note: this is separate from any FIPS-CC configurations on any GlobalProtect portals or gateways. This workaround is specific to FIPS-CC mode on the GlobalProtect app. GlobalProtect portals or gateways do not need to use FIPS-CC mode as part of this workaround.</p>"
                        }
                    ],
                    "value": "You can mitigate this issue for all platforms ( Windows https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-windows-registry ,  macOS https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-macos-property-list ,  Linux https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-on-linux-endpoints-redhat ,  iOS https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-workspaceone-on-ios-devices ,  Android https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-microsoft-intune-on-android-endpoints ) by using the GlobalProtect app 6.0 in FIPS-CC mode or GlobalProtect app 5.1 in FIPS-CC mode. For details, refer to the first \"FIPS-CC Certification Validation\" table in  our documentation https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues .\n\nNote: this is separate from any FIPS-CC configurations on any GlobalProtect portals or gateways. This workaround is specific to FIPS-CC mode on the GlobalProtect app. GlobalProtect portals or gateways do not need to use FIPS-CC mode as part of this workaround."
                }
            ],
            "x_affectedList": [
                "GlobalProtect App 6.3.1",
                "GlobalProtect App 6.3.0",
                "GlobalProtect App 6.3",
                "GlobalProtect App 6.2.4",
                "GlobalProtect App 6.2.3",
                "GlobalProtect App 6.2.2",
                "GlobalProtect App 6.2.1",
                "GlobalProtect App 6.2.0",
                "GlobalProtect App 6.2"
            ],
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        },
        "adp": [
            {
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2024-11-27T04:55:17.649111Z",
                                "id": "CVE-2024-5921",
                                "options": [
                                    {
                                        "Exploitation": "poc"
                                    },
                                    {
                                        "Automatable": "no"
                                    },
                                    {
                                        "Technical Impact": "total"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2024-11-27T16:57:39.512Z"
                }
            }
        ]
    }
}